%turbo-frame.lifetimes-single.container{id: qualify(@lifetime)}
	= notification
	= form_for @lifetime, url: single_lifetime_url(id: @lifetime.id, year: @selected_year) do |form|
		= form.hidden_field :view_mode, value: @view_mode

		%div.chart-block{class: @view_mode}
			= render layout: 'shared/lapse' do
				- if @view_mode == :donut
					%div.chart{'data-controller': 'lifetime', 'data-action': 'periodChanged@document->lifetime#handlePeriodChanged', 'data-lifetime-periods': @periods.to_json, 'data-lifetime-selected-year': @selected_year}
						%canvas{'data-lifetime-target': 'canvas'}
					= render partial: 'lifetimes/year_switcher'
				- if @view_mode == :list || @periods.empty?
					%div.loop

		%div.info-block{class: cn(@view_mode, @lifetime.periods.empty? ? 'empty' : nil)}
			%div.left
				%div.title-container
					= shared 'editable_text', { html_class: 'text-l stroke', text: @lifetime.title, placeholder: '–ù–∞–∑–≤–∞–Ω–∏–µ', enabled: @editable, form_field: :title, form: }
					- if @lifetime.private?
						%span.privacy-indicator{title: "Private - Only visible to you"}
							üîí
				= shared 'editable_text', { html_class: 'text-s description', text: @lifetime.description, placeholder: '–û–ø–∏—Å–∞–Ω–∏–µ', enabled: @editable, form_field: :description, form: }
				- if @editable
					= shared 'points', { form: form, text_start_point: @lifetime.start_point, text_finish_point: @lifetime.finish_point, }
					
					= shared 'checkbox', { text_unchecked: '–°–¥–µ–ª–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–º', text_checked: '–°–¥–µ–ª–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–º', checked: @lifetime.private?, form_field: :private, form: }
				= shared 'tab_select', { items: [{ label: '–ü–æ –≥–æ–¥–∞–º', link: set_param('view-mode', 'donut') }, { label: '–°–ø–∏—Å–∫–æ–º', link: set_param('view-mode', 'list') }] }
				- if @editable
					= shared 'button', { text: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è', form:, advance: true, size: 'xs' }
				- elsif @owned
					= shared 'button', { text: '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å', link: set_param('edit', 1), advance: true, size: 'xs' }
			%div.right
				- if @view_mode == :donut
					= render partial: 'lifetimes/periods', locals: { hide_years: true, form: }

		- if @view_mode == :list
			%div.periods-block
				= render partial: 'lifetimes/periods', locals: { form: }

	%div.social-block
		= shared 'profile_preview', { image: 'profile_mock.webp', title: '–ê—Ä–∏–Ω–∞ –ê—Ä—Ç–∞–º–æ–Ω–æ–≤–∞', subtitle: '256 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤' }
		= render partial: 'lifetimes/likes'

	- if @editable || @owned
		%div.actions-block
			- if @editable
				= shared 'button', { text: '–£–¥–∞–ª–∏—Ç—å Lifetime', link: single_lifetime_url, method: :delete, size: 'xs', color: 'red' }

	%div.comments-block
		%h1.text-l.stroke.heading –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
		= render partial: 'lifetimes/comments'
